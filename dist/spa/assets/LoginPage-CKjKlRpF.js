import{Q as z,a as E,b as I,c as L}from"./QTabPanels-DARVHUmd.js";import{b as M,i as Z,g as T,e as D,f as B,u as P,h as k,j as _,k as V,l as K,c as x,o as S,w as o,a as e,m as f,Q as h,n as U,p as w,q as y,s as N,t as A,v as C,x as F,y as R,z as j}from"./index-BC-IVWuX.js";import{Q as q}from"./QForm-Crc3LPx-.js";import{Q as H}from"./QPage-D0xTB2r_.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QResizeObserver-_P2_vINw.js";import"./rtl-DFPa-2ov.js";import"./touch-BjYP5sR0.js";import"./selection-BrULI515.js";function Q(s){if(s===!1)return 0;if(s===!0||s===void 0)return 1;const l=parseInt(s,10);return isNaN(l)?0:l}const W=M({name:"close-popup",beforeMount(s,{value:l}){const n={depth:Q(l),handler(u){n.depth!==0&&setTimeout(()=>{const t=T(s);t!==void 0&&D(t,u,n.depth)})},handlerKey(u){Z(u,13)===!0&&n.handler(u)}};s.__qclosepopup=n,s.addEventListener("click",n.handler),s.addEventListener("keyup",n.handlerKey)},updated(s,{value:l,oldValue:n}){l!==n&&(s.__qclosepopup.depth=Q(l))},beforeUnmount(s){const l=s.__qclosepopup;s.removeEventListener("click",l.handler),s.removeEventListener("keyup",l.handlerKey),delete s.__qclosepopup}}),G={class:"q-mt-md"},J={class:"text-center q-mt-sm"},O={__name:"LoginForm",setup(s){const l=B(),n=P(),{showSuccess:u,showError:t}=k(),p=_(!0),g=V(()=>n.loading),m=K({email:"",password:""}),c=b=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(b)||"Invalid email format",d=()=>{l.push("/reset-password")},v=async()=>{let b=await n.loginUser(m);const{success:r,error:a}=b;r&&(console.log("Login successful!"),u("Login successful!")),a&&t(a.message)};return(b,r)=>(S(),x(q,{onSubmit:v,class:"q-gutter-md"},{default:o(()=>[e(h,{modelValue:m.email,"onUpdate:modelValue":r[0]||(r[0]=a=>m.email=a),label:"Email",type:"email",outlined:"",rules:[a=>!!a||"Email is required",c]},null,8,["modelValue","rules"]),e(h,{modelValue:m.password,"onUpdate:modelValue":r[2]||(r[2]=a=>m.password=a),label:"Password",type:p.value?"password":"text",outlined:"",rules:[a=>!!a||"Password is required"]},{append:o(()=>[e(U,{name:p.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:r[1]||(r[1]=a=>p.value=!p.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),f("div",G,[e(w,{label:"Sign In",type:"submit",color:"primary",class:"full-width",loading:g.value},null,8,["loading"])]),f("div",J,[e(w,{flat:"",color:"primary",label:"Forgot Password?",onClick:d,disable:g.value},null,8,["disable"])])]),_:1}))}},X={class:"q-mt-md"},Y={__name:"MagicLinkLogin",setup(s){const l=P(),{showSuccess:n,showError:u}=k(),t=_(""),p=V(()=>l.loading),g=c=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(c)||"Invalid email format",m=async()=>{const{success:c,error:d}=await l.signInWithMagicLink(t.value);d?u(d.message):c&&n("Magic link sent! Check your email to sign in.")};return(c,d)=>(S(),x(q,{onSubmit:m,class:"q-gutter-md"},{default:o(()=>[e(h,{modelValue:t.value,"onUpdate:modelValue":d[0]||(d[0]=v=>t.value=v),label:"Email for Magic Link",type:"email",outlined:"",rules:[v=>!!v||"Email is required",g]},null,8,["modelValue","rules"]),f("div",X,[e(w,{label:"Send Magic Link",type:"submit",color:"secondary",class:"full-width",loading:p.value},null,8,["loading"])])]),_:1}))}},ee={class:"text-center"},ae={__name:"AuthCard",emits:["show-signup"],setup(s){const l=P(),n=V(()=>l.loading);return(u,t)=>(S(),x(C,{class:"auth-card"},{default:o(()=>[e(y,{class:"text-center"},{default:o(()=>t[1]||(t[1]=[f("div",{class:"text-h4 text-primary q-mb-md"},"High Risk Patient Medication Audit",-1),f("div",{class:"text-subtitle1 q-mb-lg"},"Please sign in to continue",-1)])),_:1}),e(y,null,{default:o(()=>[N(u.$slots,"main-content",{},void 0,!0)]),_:3}),e(A,{class:"q-my-md"}),e(y,null,{default:o(()=>[f("div",ee,[t[2]||(t[2]=f("p",{class:"text-grey-8"},"Don't have an account?",-1)),e(w,{outline:"",color:"secondary",label:"Sign Up",class:"full-width",onClick:t[0]||(t[0]=p=>u.$emit("show-signup")),disable:n.value},null,8,["disable"])])]),_:1})]),_:3}))}},se=$(ae,[["__scopeId","data-v-817fe71e"]]),le={class:"q-mt-md"},te={__name:"LoginPage",setup(s){const l=P(),{showSuccess:n,showError:u}=k(),t=_("password"),p=V(()=>l.loading),g=_(!1),m=_(""),c=_(""),d=_(!0),v=r=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(r)||"Invalid email format",b=()=>{console.log("credentials: ",m.value,c.value);const{success:r,error:a}=l.registerUser({email:m.value,password:c.value});r?(n("Sign up successful! Please check your email for verification."),g.value=!1):u(a||"Sign up failed")};return(r,a)=>(S(),x(H,{padding:"",class:"flex flex-center"},{default:o(()=>[e(se,{onShowSignup:a[2]||(a[2]=i=>g.value=!0)},{"main-content":o(()=>[e(z,{modelValue:t.value,"onUpdate:modelValue":a[0]||(a[0]=i=>t.value=i),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:o(()=>[e(E,{name:"password",label:"Email/Password"}),e(E,{name:"magiclink",label:"Magic Link"})]),_:1},8,["modelValue"]),e(A),e(I,{modelValue:t.value,"onUpdate:modelValue":a[1]||(a[1]=i=>t.value=i),animated:""},{default:o(()=>[e(L,{name:"password"},{default:o(()=>[e(O)]),_:1}),e(L,{name:"magiclink"},{default:o(()=>[e(Y)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(F,{modelValue:g.value,"onUpdate:modelValue":a[6]||(a[6]=i=>g.value=i)},{default:o(()=>[e(C,{style:{"min-width":"350px"}},{default:o(()=>[e(y,{class:"text-center"},{default:o(()=>a[7]||(a[7]=[f("div",{class:"text-h6"},"Create Account",-1)])),_:1}),e(y,null,{default:o(()=>[e(q,{onSubmit:b,class:"q-gutter-md"},{default:o(()=>[e(h,{modelValue:m.value,"onUpdate:modelValue":a[3]||(a[3]=i=>m.value=i),label:"Email",type:"email",outlined:"",rules:[i=>!!i||"Email is required",v]},null,8,["modelValue","rules"]),e(h,{modelValue:c.value,"onUpdate:modelValue":a[5]||(a[5]=i=>c.value=i),label:"Password",type:d.value?"password":"text",outlined:"",rules:[i=>!!i||"Password is required",i=>i.length>=6||"Password must be at least 6 characters"]},{append:o(()=>[e(U,{name:d.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:a[4]||(a[4]=i=>d.value=!d.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),f("div",le,[e(w,{label:"Sign Up",type:"submit",color:"secondary",class:"full-width",loading:p.value},null,8,["loading"])])]),_:1})]),_:1}),e(R,{align:"right"},{default:o(()=>[j(e(w,{flat:"",label:"Cancel",color:"primary",disable:p.value},null,8,["disable"]),[[W]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},ge=$(te,[["__scopeId","data-v-44f58289"]]);export{ge as default};
