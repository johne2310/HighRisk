import{b as C,i as E,g as L,e as A,f as c,h as I,c as D,o as $,w as o,u as B,a,Q as x,j as y,k as d,l as b,m as q,n as m,p as K,q as N,s as z,t as F}from"./index-CKTWYCVV.js";import{Q as V}from"./QForm-Dwu3siC4.js";import{Q as Z}from"./QPage-C4ev0Jjg.js";import{u as M}from"./use-quasar-CY6PfAoB.js";import{useAuthStore as R}from"./auth-store-C9xprJxx.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-Ch6scGxN.js";function k(l){if(l===!1)return 0;if(l===!0||l===void 0)return 1;const t=parseInt(l,10);return isNaN(t)?0:t}const H=C({name:"close-popup",beforeMount(l,{value:t}){const i={depth:k(t),handler(n){i.depth!==0&&setTimeout(()=>{const r=L(l);r!==void 0&&A(r,n,i.depth)})},handlerKey(n){E(n,13)===!0&&i.handler(n)}};l.__qclosepopup=i,l.addEventListener("click",i.handler),l.addEventListener("keyup",i.handlerKey)},updated(l,{value:t,oldValue:i}){t!==i&&(l.__qclosepopup.depth=k(t))},beforeUnmount(l){const t=l.__qclosepopup;l.removeEventListener("click",t.handler),l.removeEventListener("keyup",t.handlerKey),delete l.__qclosepopup}}),T={class:"q-mt-md"},G={class:"text-center q-mt-sm"},J={class:"text-center"},O={class:"q-mt-md"},W={__name:"LoginPage",setup(l){const t=M(),i=B(),n=R(),r=c(""),w=c(""),p=c(!0),f=I(()=>n.loading),v=c(!1),P=c(""),_=c(""),g=c(!0),h=u=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(u)||"Invalid email format",Q=async()=>{const{success:u,error:e}=await n.signIn(r.value,w.value);u?(t.notify({color:"positive",message:"Login successful",icon:"check_circle"}),i.push("/dashboard")):t.notify({color:"negative",message:e||"Login failed",icon:"error"})},S=async()=>{const{success:u,error:e}=await n.signUp(P.value,_.value);u?(t.notify({color:"positive",message:"Sign up successful! Please check your email for verification.",icon:"check_circle"}),v.value=!1):t.notify({color:"negative",message:e||"Sign up failed",icon:"error"})},U=async()=>{if(!r.value){t.notify({color:"warning",message:"Please enter your email address",icon:"warning"});return}const{success:u,error:e}=await n.resetPassword(r.value);u?t.notify({color:"positive",message:"Password reset email sent. Please check your inbox.",icon:"check_circle"}):t.notify({color:"negative",message:e||"Failed to send reset email",icon:"error"})};return(u,e)=>($(),D(Z,{padding:"",class:"flex flex-center"},{default:o(()=>[a(x,{class:"auth-card"},{default:o(()=>[a(y,{class:"text-center"},{default:o(()=>e[8]||(e[8]=[d("div",{class:"text-h4 text-primary q-mb-md"},"High Risk Patient Medication Audit",-1),d("div",{class:"text-subtitle1 q-mb-lg"},"Please sign in to continue",-1)])),_:1}),a(y,null,{default:o(()=>[a(V,{onSubmit:Q,class:"q-gutter-md"},{default:o(()=>[a(b,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=s=>r.value=s),label:"Email",type:"email",outlined:"",rules:[s=>!!s||"Email is required",h]},null,8,["modelValue","rules"]),a(b,{modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=s=>w.value=s),label:"Password",type:p.value?"password":"text",outlined:"",rules:[s=>!!s||"Password is required"]},{append:o(()=>[a(q,{name:p.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[1]||(e[1]=s=>p.value=!p.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),d("div",T,[a(m,{label:"Sign In",type:"submit",color:"primary",class:"full-width"})]),d("div",G,[a(m,{flat:"",color:"primary",label:"Forgot Password?",onClick:U,disable:f.value},null,8,["disable"])]),a(K,{class:"q-my-md"}),d("div",J,[e[9]||(e[9]=d("p",{class:"text-grey-8"},"Don't have an account?",-1)),a(m,{outline:"",color:"secondary",label:"Sign Up",class:"full-width",onClick:e[3]||(e[3]=s=>v.value=!0),disable:f.value},null,8,["disable"])])]),_:1})]),_:1})]),_:1}),a(N,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=s=>v.value=s)},{default:o(()=>[a(x,{style:{"min-width":"350px"}},{default:o(()=>[a(y,{class:"text-center"},{default:o(()=>e[10]||(e[10]=[d("div",{class:"text-h6"},"Create Account",-1)])),_:1}),a(y,null,{default:o(()=>[a(V,{onSubmit:S,class:"q-gutter-md"},{default:o(()=>[a(b,{modelValue:P.value,"onUpdate:modelValue":e[4]||(e[4]=s=>P.value=s),label:"Email",type:"email",outlined:"",rules:[s=>!!s||"Email is required",h]},null,8,["modelValue","rules"]),a(b,{modelValue:_.value,"onUpdate:modelValue":e[6]||(e[6]=s=>_.value=s),label:"Password",type:g.value?"password":"text",outlined:"",rules:[s=>!!s||"Password is required",s=>s.length>=6||"Password must be at least 6 characters"]},{append:o(()=>[a(q,{name:g.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[5]||(e[5]=s=>g.value=!g.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),d("div",O,[a(m,{label:"Sign Up",type:"submit",color:"secondary",class:"full-width",loading:f.value},null,8,["loading"])])]),_:1})]),_:1}),a(z,{align:"right"},{default:o(()=>[F(a(m,{flat:"",label:"Cancel",color:"primary",disable:f.value},null,8,["disable"]),[[H]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},oe=j(W,[["__scopeId","data-v-8c312f12"]]);export{oe as default};
