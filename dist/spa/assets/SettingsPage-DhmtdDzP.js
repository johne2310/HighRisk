import{c as ue,ah as x,y as de,N as ce,A as fe,g as ve,r as p,a as h,az as me,C as ge,ai as pe,D as he,aA as ye,w as N,o as U,k as F,q as I,O as Se,h as M,aj as we,b as be,x as Te,ay as He,H as Pe,W as O,X as E,Y as T,a3 as C,_ as w,ab as Ce,ac as We,ad as ke,a5 as b,aB as Ve,a4 as xe,Z as Oe,a0 as Ee}from"./index-D8Nd6p7p.js";import{v as _e,b as j,d as Qe,p as z,e as qe,f as Be,g as De,r as L,s as Ae,Q as $}from"./QSelect-DBVnm3t6.js";import{c as R}from"./QItem-DTrE9b6Y.js";import{Q as Ne}from"./QForm-aiHYy2K7.js";import{Q as Ue}from"./QPage-OZMN7Qm_.js";import{u as Fe}from"./use-quasar-DgEGoSi7.js";import{u as Ie}from"./settings-store-BcNW1Dj9.js";import{e as X}from"./index-DMppvs0A.js";const Me=ue({name:"QTooltip",inheritAttrs:!1,props:{...Qe,...fe,...x,maxHeight:{type:String,default:null},maxWidth:{type:String,default:null},transitionShow:{...x.transitionShow,default:"jump-down"},transitionHide:{...x.transitionHide,default:"jump-up"},anchor:{type:String,default:"bottom middle",validator:j},self:{type:String,default:"top middle",validator:j},offset:{type:Array,default:()=>[14,14],validator:_e},scrollTarget:ce,delay:{type:Number,default:0},hideDelay:{type:Number,default:0},persistent:Boolean},emits:[...de],setup(e,{slots:v,emit:c,attrs:a}){let l,m;const n=ve(),{proxy:{$q:s}}=n,f=p(null),y=p(!1),t=h(()=>z(e.anchor,s.lang.rtl)),r=h(()=>z(e.self,s.lang.rtl)),i=h(()=>e.persistent!==!0),{registerTick:o,removeTick:d}=me(),{registerTimeout:W}=ge(),{transitionProps:Y,transitionStyle:Z}=pe(e),{localScrollTarget:_,changeScrollEvent:G,unconfigureScrollTarget:J}=qe(e,D),{anchorEl:g,canShow:K,anchorEvents:H}=Be({showing:y,configureAnchorEl:ie}),{show:ee,hide:k}=he({showing:y,canShow:K,handleShow:ae,handleHide:oe,hideOnRouteChange:i,processOnMount:!0});Object.assign(H,{delayShow:le,delayHide:se});const{showPortal:Q,hidePortal:q,renderPortal:te}=ye(n,f,re,"tooltip");if(s.platform.is.mobile===!0){const u={anchorEl:g,innerRef:f,onClickOutside(S){return k(S),S.target.classList.contains("q-dialog__backdrop")&&Te(S),!0}},V=h(()=>e.modelValue===null&&e.persistent!==!0&&y.value===!0);N(V,S=>{(S===!0?De:L)(u)}),U(()=>{L(u)})}function ae(u){Q(),o(()=>{m=new MutationObserver(()=>P()),m.observe(f.value,{attributes:!1,childList:!0,characterData:!0,subtree:!0}),P(),D()}),l===void 0&&(l=N(()=>s.screen.width+"|"+s.screen.height+"|"+e.self+"|"+e.anchor+"|"+s.lang.rtl,P)),W(()=>{Q(!0),c("show",u)},e.transitionDuration)}function oe(u){d(),q(),B(),W(()=>{q(!0),c("hide",u)},e.transitionDuration)}function B(){m!==void 0&&(m.disconnect(),m=void 0),l!==void 0&&(l(),l=void 0),J(),F(H,"tooltipTemp")}function P(){Ae({targetEl:f.value,offset:e.offset,anchorEl:g.value,anchorOrigin:t.value,selfOrigin:r.value,maxHeight:e.maxHeight,maxWidth:e.maxWidth})}function le(u){if(s.platform.is.mobile===!0){R(),document.body.classList.add("non-selectable");const V=g.value,S=["touchmove","touchcancel","touchend","click"].map(A=>[V,A,"delayHide","passiveCapture"]);I(H,"tooltipTemp",S)}W(()=>{ee(u)},e.delay)}function se(u){s.platform.is.mobile===!0&&(F(H,"tooltipTemp"),R(),setTimeout(()=>{document.body.classList.remove("non-selectable")},10)),W(()=>{k(u)},e.hideDelay)}function ie(){if(e.noParentEvent===!0||g.value===null)return;const u=s.platform.is.mobile===!0?[[g.value,"touchstart","delayShow","passive"]]:[[g.value,"mouseenter","delayShow","passive"],[g.value,"mouseleave","delayHide","passive"]];I(H,"anchor",u)}function D(){if(g.value!==null||e.scrollTarget!==void 0){_.value=Se(g.value,e.scrollTarget);const u=e.noParentEvent===!0?P:k;G(_.value,u)}}function ne(){return y.value===!0?M("div",{...a,ref:f,class:["q-tooltip q-tooltip--style q-position-engine no-pointer-events",a.class],style:[a.style,Z.value],role:"tooltip"},be(v.default)):null}function re(){return M(we,Y.value,ne)}return U(B),Object.assign(n.proxy,{updatePosition:P}),te}}),je=He("hospital",()=>{const e=p([]),v=p([]),c=p(!1),a=p(null),l=h(()=>t=>t?v.value.filter(r=>r.hospital_id===t):[]),m=h(()=>t=>e.value.find(r=>r.hospital_id===t)),n=h(()=>t=>v.value.find(r=>r.ward_id===t)),s=async()=>{c.value=!0,a.value=null;try{const{data:t,error:r}=await X.from("hospitals").select("*");if(r)throw r;return e.value=t||[],{success:!0,data:t}}catch(t){return console.error("Error fetching hospitals:",t),a.value=t.message||"Failed to fetch hospitals",{success:!1,error:a.value}}finally{c.value=!1}},f=async()=>{c.value=!0,a.value=null;try{const{data:t,error:r}=await X.from("wards").select("*");if(r)throw r;return v.value=t||[],{success:!0,data:t}}catch(t){return console.error("Error fetching wards:",t),a.value=t.message||"Failed to fetch wards",{success:!1,error:a.value}}finally{c.value=!1}};return{hospitals:e,wards:v,loading:c,error:a,getFilteredWards:l,getHospitalById:m,getWardById:n,fetchHospitals:s,fetchWards:f,initializeData:async()=>{await Promise.all([s(),f()])}}}),ze={class:"row q-col-gutter-md"},Le={class:"col-12 col-md-6"},et={__name:"SettingsPage",setup(e){const v=Fe(),c=Ie(),a=je(),{userSettings:l,appSettings:m}=c,n=p(null),s=p(null),f=h(()=>a.getFilteredWards(n.value));function y(){if(s.value=null,console.log("Selected hospital ID:",n.value),n.value){const i=a.getHospitalById(n.value);console.log("Hospital change details:",i),i&&(l.defaultHospital=i.hospital)}}function t(){if(s.value){const i=a.getWardById(s.value);i&&(console.log("Ward being change: ",i),l.defaultWard=i.ward)}}Pe(async()=>{await a.initializeData(),console.log("hospital store: ",a.hospitals),console.log("ward store: ",a.wards),setTimeout(()=>{if(l.defaultHospital){const i=a.hospitals.find(o=>o.hospital===l.defaultHospital);i&&(n.value=i.hospital_id)}if(l.defaultWard){const i=a.wards.find(o=>o.ward===l.defaultWard);i&&(s.value=i.ward_id)}},500)});const r=()=>{const i=c.saveUserSettings();i.success?v.notify({color:"positive",icon:"check_circle",message:"User settings saved successfully",position:"top",timeout:2e3}):v.notify({color:"negative",icon:"error",message:`Failed to save user settings: ${i.error}`,position:"top",timeout:2e3})};return(i,o)=>(E(),O(Ue,{padding:""},{default:T(()=>[o[6]||(o[6]=C("div",{class:"text-h4 text-primary q-mb-md"},"Application Settings",-1)),C("div",ze,[C("div",Le,[w(Ce,null,{default:T(()=>[w(We,null,{default:T(()=>[o[5]||(o[5]=C("div",{class:"text-h6"},"User Settings",-1)),w(Ne,{class:"q-gutter-md q-mt-md"},{default:T(()=>[w(ke,{filled:"",modelValue:b(l).defaultName,"onUpdate:modelValue":o[0]||(o[0]=d=>b(l).defaultName=d),label:"Default Collector Name"},null,8,["modelValue"]),w($,{filled:"",modelValue:n.value,"onUpdate:modelValue":[o[1]||(o[1]=d=>n.value=d),y],options:b(a).hospitals,label:"Select Hospital","option-label":"hospital","option-value":"hospital_id","map-options":"","emit-value":"",rules:[d=>!!d||"Hospital selection is required"]},null,8,["modelValue","options","rules"]),(E(),O($,{filled:"",modelValue:s.value,"onUpdate:modelValue":[o[2]||(o[2]=d=>s.value=d),t],options:f.value,label:"Select Ward","option-label":"ward","option-value":"ward_id","map-options":"","emit-value":"",rules:[d=>!!d||"Ward selection is required"],disable:!n.value,key:"ward-select-"+(n.value||"none")},null,8,["modelValue","options","rules","disable"])),w(Ve,{modelValue:b(l).autoSave,"onUpdate:modelValue":o[3]||(o[3]=d=>b(l).autoSave=d),label:"Auto save settings"},null,8,["modelValue"]),C("div",null,[w(xe,{color:"primary",label:"Save User Settings",onClick:r,disable:b(l).autoSave},{default:T(()=>[b(m).autoSave?(E(),O(Me,{key:0},{default:T(()=>o[4]||(o[4]=[Ee(" Settings are automatically saved when auto-save is enabled ")])),_:1})):Oe("",!0)]),_:1},8,["disable"])])]),_:1})]),_:1})]),_:1})])])]),_:1}))}};export{et as default};
