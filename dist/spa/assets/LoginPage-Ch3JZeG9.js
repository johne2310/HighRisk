import{Q as z,a as q,b as I,c as L}from"./QTabPanels-CkeXPIU6.js";import{b as M,i as Z,g as T,e as D,f as B,u as h,h as S,j as w,k as V,l as E,c as P,o as x,w as n,a as e,m as f,Q as y,n as U,p as _,q as b,s as K,t as A,v as C,x as N,y as F,z as R}from"./index-BqFD115I.js";import{Q as k}from"./QForm-bPdlBEz-.js";import{Q as j}from"./QPage-igKuEyal.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QResizeObserver-B8HYA6WF.js";import"./rtl-DFPa-2ov.js";import"./touch-BjYP5sR0.js";import"./selection-CYTWF6qT.js";function Q(t){if(t===!1)return 0;if(t===!0||t===void 0)return 1;const l=parseInt(t,10);return isNaN(l)?0:l}const H=M({name:"close-popup",beforeMount(t,{value:l}){const i={depth:Q(l),handler(r){i.depth!==0&&setTimeout(()=>{const o=T(t);o!==void 0&&D(o,r,i.depth)})},handlerKey(r){Z(r,13)===!0&&i.handler(r)}};t.__qclosepopup=i,t.addEventListener("click",i.handler),t.addEventListener("keyup",i.handlerKey)},updated(t,{value:l,oldValue:i}){l!==i&&(t.__qclosepopup.depth=Q(l))},beforeUnmount(t){const l=t.__qclosepopup;t.removeEventListener("click",l.handler),t.removeEventListener("keyup",l.handlerKey),delete t.__qclosepopup}}),W={class:"q-mt-md"},G={class:"text-center q-mt-sm"},J={__name:"LoginForm",setup(t){const l=B(),i=h(),{showSuccess:r,showError:o}=S(),m=w(!0),p=V(()=>i.loading),d=E({email:"",password:""}),u=g=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(g)||"Invalid email format",c=()=>{console.log("reset password"),l.push({name:"reset-password"})},v=async()=>{console.log("sending credentials: ",d);let g=await i.loginUser(d);const{success:s,error:a}=g;s&&(console.log("Login successful!"),r("Login successful!")),a&&o(a.message)};return(g,s)=>(x(),P(k,{onSubmit:v,class:"q-gutter-md"},{default:n(()=>[e(y,{modelValue:d.email,"onUpdate:modelValue":s[0]||(s[0]=a=>d.email=a),label:"Email",type:"email",outlined:"",rules:[a=>!!a||"Email is required",u]},null,8,["modelValue","rules"]),e(y,{modelValue:d.password,"onUpdate:modelValue":s[2]||(s[2]=a=>d.password=a),label:"Password",type:m.value?"password":"text",outlined:"",rules:[a=>!!a||"Password is required"]},{append:n(()=>[e(U,{name:m.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>m.value=!m.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),f("div",W,[e(_,{label:"Sign In",type:"submit",color:"primary",class:"full-width",loading:p.value},null,8,["loading"])]),f("div",G,[e(_,{flat:"",color:"primary",label:"Forgot Password?",onClick:c,disable:p.value},null,8,["disable"])])]),_:1}))}},O={class:"q-mt-md"},X={__name:"MagicLinkLogin",setup(t){const l=h(),{showSuccess:i,showError:r}=S(),o=w(""),m=V(()=>l.loading),p=u=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(u)||"Invalid email format",d=async()=>{const{success:u,error:c}=await l.signInWithMagicLink(o.value);c?r(c.message):u&&i("Magic link sent! Check your email to sign in.")};return(u,c)=>(x(),P(k,{onSubmit:d,class:"q-gutter-md"},{default:n(()=>[e(y,{modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=v=>o.value=v),label:"Email for Magic Link",type:"email",outlined:"",rules:[v=>!!v||"Email is required",p]},null,8,["modelValue","rules"]),f("div",O,[e(_,{label:"Send Magic Link",type:"submit",color:"secondary",class:"full-width",loading:m.value},null,8,["loading"])])]),_:1}))}},Y={class:"text-center"},ee={__name:"AuthCard",emits:["show-signup"],setup(t){const l=h(),i=V(()=>l.loading);return(r,o)=>(x(),P(C,{class:"auth-card"},{default:n(()=>[e(b,{class:"text-center"},{default:n(()=>o[1]||(o[1]=[f("div",{class:"text-h4 text-primary q-mb-md"},"High Risk Patient Medication Audit",-1),f("div",{class:"text-subtitle1 q-mb-lg"},"Please sign in to continue",-1)])),_:1}),e(b,null,{default:n(()=>[K(r.$slots,"main-content",{},void 0,!0)]),_:3}),e(A,{class:"q-my-md"}),e(b,null,{default:n(()=>[f("div",Y,[o[2]||(o[2]=f("p",{class:"text-grey-8"},"Don't have an account?",-1)),e(_,{outline:"",color:"secondary",label:"Sign Up",class:"full-width",onClick:o[0]||(o[0]=m=>r.$emit("show-signup")),disable:i.value},null,8,["disable"])])]),_:1})]),_:3}))}},ae=$(ee,[["__scopeId","data-v-817fe71e"]]),se={class:"q-mt-md"},te={__name:"LoginPage",setup(t){const l=h(),{showSuccess:i,showError:r}=S(),o=w("password"),m=V(()=>l.loading),p=w(!1),d=w(!0),u=E({email:"",password:""}),c=g=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(g)||"Invalid email format",v=async()=>{console.log("credentials: ",u);let g=await l.registerUser(u);const{success:s,error:a}=g;s&&(i("Sign up successful! Please check your email for verification."),p.value=!1),a&&r(a.message||"Sign up failed")};return(g,s)=>(x(),P(j,{padding:"",class:"flex flex-center"},{default:n(()=>[e(ae,{onShowSignup:s[2]||(s[2]=a=>p.value=!0)},{"main-content":n(()=>[e(z,{modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=a=>o.value=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:n(()=>[e(q,{name:"password",label:"Email/Password"}),e(q,{name:"magiclink",label:"Magic Link"})]),_:1},8,["modelValue"]),e(A),e(I,{modelValue:o.value,"onUpdate:modelValue":s[1]||(s[1]=a=>o.value=a),animated:""},{default:n(()=>[e(L,{name:"password"},{default:n(()=>[e(J)]),_:1}),e(L,{name:"magiclink"},{default:n(()=>[e(X)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(N,{modelValue:p.value,"onUpdate:modelValue":s[6]||(s[6]=a=>p.value=a)},{default:n(()=>[e(C,{style:{"min-width":"350px"}},{default:n(()=>[e(b,{class:"text-center"},{default:n(()=>s[7]||(s[7]=[f("div",{class:"text-h6"},"Create Account",-1)])),_:1}),e(b,null,{default:n(()=>[e(k,{onSubmit:v,class:"q-gutter-md"},{default:n(()=>[e(y,{modelValue:u.email,"onUpdate:modelValue":s[3]||(s[3]=a=>u.email=a),label:"Email",type:"email",outlined:"",rules:[a=>!!a||"Email is required",c]},null,8,["modelValue","rules"]),e(y,{modelValue:u.password,"onUpdate:modelValue":s[5]||(s[5]=a=>u.password=a),label:"Password",type:d.value?"password":"text",outlined:"",rules:[a=>!!a||"Password is required",a=>a.length>=6||"Password must be at least 6 characters"]},{append:n(()=>[e(U,{name:d.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[4]||(s[4]=a=>d.value=!d.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),f("div",se,[e(_,{label:"Sign Up",type:"submit",color:"secondary",class:"full-width",loading:m.value},null,8,["loading"])])]),_:1})]),_:1}),e(F,{align:"right"},{default:n(()=>[R(e(_,{flat:"",label:"Cancel",color:"primary",disable:m.value},null,8,["disable"]),[[H]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},pe=$(te,[["__scopeId","data-v-fc4fed60"]]);export{pe as default};
