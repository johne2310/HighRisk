import{am as S,f as l,D as u}from"./index-TGzrOE7f.js";const a=()=>{try{const s="__test__";return localStorage.setItem(s,s),localStorage.removeItem(s),!0}catch{return!1}},d=S("settings",()=>{const s=l({defaultName:"",defaultHospital:null,defaultWard:null,rememberSettings:!0}),t=l({theme:"blue",dateFormat:"YYYY-MM-DD",notifications:!0,autoSave:!0}),o=l(!1),r=l(null),i=()=>{if(!a()){console.warn("localStorage is not available");return}try{const e=localStorage.getItem("userSettings"),g=localStorage.getItem("appSettings");e&&(s.value=JSON.parse(e)),g&&(t.value=JSON.parse(g))}catch(e){console.error("Error loading settings from localStorage:",e),r.value=e.message||"Failed to load settings"}};typeof window<"u"&&a()&&i(),u(()=>t.value.autoSave,e=>{e&&typeof window<"u"&&a()&&v()},{immediate:!0});function v(){t.value.autoSave&&a()&&(u(s,()=>{t.value.autoSave&&a()&&c()},{deep:!0}),u(t,()=>{t.value.autoSave&&a()&&n()},{deep:!0}))}const c=()=>{if(o.value=!0,r.value=null,!a())return console.warn("localStorage is not available"),{success:!1,error:"localStorage is not available"};try{return localStorage.setItem("userSettings",JSON.stringify(s.value)),{success:!0}}catch(e){return console.error("Error saving user settings:",e),r.value=e.message||"Failed to save user settings",{success:!1,error:r.value}}finally{o.value=!1}},n=()=>{if(o.value=!0,r.value=null,!a())return console.warn("localStorage is not available"),{success:!1,error:"localStorage is not available"};try{return localStorage.setItem("appSettings",JSON.stringify(t.value)),{success:!0}}catch(e){return console.error("Error saving app settings:",e),r.value=e.message||"Failed to save app settings",{success:!1,error:r.value}}finally{o.value=!1}};return{userSettings:s,appSettings:t,loading:o,error:r,loadSettings:i,saveUserSettings:c,saveAppSettings:n,resetAppSettings:()=>(t.value={theme:"blue",dateFormat:"YYYY-MM-DD",notifications:!0,autoSave:!0},a()?n():(console.warn("localStorage is not available"),{success:!0,warning:"Settings reset but not saved to localStorage"}))}});export{d as u};
