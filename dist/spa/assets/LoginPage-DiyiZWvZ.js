import{b as E,i as L,g as A,e as D,u as I,f as p,h as B,j as K,c as $,o as z,w as o,k as N,l as R,m as Z,a as l,Q as P,n as _,p as r,q as h,s as q,t as m,v as F,x as M,y as T,z as j}from"./index-CXRMJTF4.js";import{Q as V}from"./QForm-BmkDzY8g.js";import{Q as H}from"./QPage-C-IRiGyA.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";function S(t){if(t===!1)return 0;if(t===!0||t===void 0)return 1;const a=parseInt(t,10);return isNaN(a)?0:a}const G=E({name:"close-popup",beforeMount(t,{value:a}){const i={depth:S(a),handler(n){i.depth!==0&&setTimeout(()=>{const f=A(t);f!==void 0&&D(f,n,i.depth)})},handlerKey(n){L(n,13)===!0&&i.handler(n)}};t.__qclosepopup=i,t.addEventListener("click",i.handler),t.addEventListener("keyup",i.handlerKey)},updated(t,{value:a,oldValue:i}){a!==i&&(t.__qclosepopup.depth=S(a))},beforeUnmount(t){const a=t.__qclosepopup;t.removeEventListener("click",a.handler),t.removeEventListener("keyup",a.handlerKey),delete t.__qclosepopup}}),J={class:"q-mt-md"},W={class:"text-center q-mt-sm"},X={class:"text-center"},Y={class:"q-mt-md"},ee={__name:"LoginPage",setup(t){const a=N(),i=R(),n=I(),{showSuccess:f,showError:U}=Z(),v=p(!0),d=B(()=>n.loading),g=p(!1),y=p(""),b=p(""),w=p(!0),x=u=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(u)||"Invalid email format",c=K({email:"",password:""}),k=()=>{i.push("/reset-password")},Q=async()=>{let u=await n.loginUser(c);const{success:e,error:s}=u;e&&(console.log("Login successful!"),f("Login successful!")),s&&U(s.message)},C=()=>{console.log("credentials: ",y.value,b.value);const{success:u,error:e}=n.registerUser({email:y.value,password:b.value});u?(a.notify({color:"positive",message:"Sign up successful! Please check your email for verification.",icon:"check_circle",closeBtn:"OK"}),g.value=!1):a.notify({color:"negative",message:e||"Sign up failed",icon:"error",position:"bottom",timeout:1e3,actions:[{label:"Dismiss",color:"white",handler:()=>{}}]})};return(u,e)=>(z(),$(H,{padding:"",class:"flex flex-center"},{default:o(()=>[l(P,{class:"auth-card"},{default:o(()=>[l(_,{class:"text-center"},{default:o(()=>e[8]||(e[8]=[r("div",{class:"text-h4 text-primary q-mb-md"},"High Risk Patient Medication Audit",-1),r("div",{class:"text-subtitle1 q-mb-lg"},"Please sign in to continue",-1)])),_:1}),l(_,null,{default:o(()=>[l(V,{onSubmit:Q,class:"q-gutter-md"},{default:o(()=>[l(h,{modelValue:c.email,"onUpdate:modelValue":e[0]||(e[0]=s=>c.email=s),label:"Email",type:"email",outlined:"",rules:[s=>!!s||"Email is required",x]},null,8,["modelValue","rules"]),l(h,{modelValue:c.password,"onUpdate:modelValue":e[2]||(e[2]=s=>c.password=s),label:"Password",type:v.value?"password":"text",outlined:"",rules:[s=>!!s||"Password is required"]},{append:o(()=>[l(q,{name:v.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[1]||(e[1]=s=>v.value=!v.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),r("div",J,[l(m,{label:"Sign In",type:"submit",color:"primary",class:"full-width",loading:d.value},null,8,["loading"])]),r("div",W,[l(m,{flat:"",color:"primary",label:"Forgot Password?",onClick:k,disable:d.value},null,8,["disable"])]),l(F,{class:"q-my-md"}),r("div",X,[e[9]||(e[9]=r("p",{class:"text-grey-8"},"Don't have an account?",-1)),l(m,{outline:"",color:"secondary",label:"Sign Up",class:"full-width",onClick:e[3]||(e[3]=s=>g.value=!0),disable:d.value},null,8,["disable"])])]),_:1})]),_:1})]),_:1}),l(M,{modelValue:g.value,"onUpdate:modelValue":e[7]||(e[7]=s=>g.value=s)},{default:o(()=>[l(P,{style:{"min-width":"350px"}},{default:o(()=>[l(_,{class:"text-center"},{default:o(()=>e[10]||(e[10]=[r("div",{class:"text-h6"},"Create Account",-1)])),_:1}),l(_,null,{default:o(()=>[l(V,{onSubmit:C,class:"q-gutter-md"},{default:o(()=>[l(h,{modelValue:y.value,"onUpdate:modelValue":e[4]||(e[4]=s=>y.value=s),label:"Email",type:"email",outlined:"",rules:[s=>!!s||"Email is required",x]},null,8,["modelValue","rules"]),l(h,{modelValue:b.value,"onUpdate:modelValue":e[6]||(e[6]=s=>b.value=s),label:"Password",type:w.value?"password":"text",outlined:"",rules:[s=>!!s||"Password is required",s=>s.length>=6||"Password must be at least 6 characters"]},{append:o(()=>[l(q,{name:w.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[5]||(e[5]=s=>w.value=!w.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),r("div",Y,[l(m,{label:"Sign Up",type:"submit",color:"secondary",class:"full-width",loading:d.value},null,8,["loading"])])]),_:1})]),_:1}),l(T,{align:"right"},{default:o(()=>[j(l(m,{flat:"",label:"Cancel",color:"primary",disable:d.value},null,8,["disable"]),[[G]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},oe=O(ee,[["__scopeId","data-v-e1c11578"]]);export{oe as default};
