import{f as u,u as C,a1 as Q,c as V,o as d,w as c,l as x,an as A,k as S,a as o,Q as U,m as v,n as w,a6 as f,a3 as p,p as h,s as q,a5 as P}from"./index-CSjNZ9aV.js";import{Q as B}from"./QForm-B_oto_wx.js";import{Q as N}from"./QPage-BnCua36y.js";import{_ as R}from"./_plugin-vue_export-helper-DlAUqK2U.js";const T={key:0,class:"text-red"},E={key:1,class:"text-green"},i=null,F={__name:"ChangePasswordPage",setup(L){const l=u(""),g=u(""),t=u(!1),n=u(null),r=u(null),_=x(),k=A(),y=C(),m=S();Q(()=>{if(window.location.hash){const a=new URLSearchParams(window.location.hash.substring(1));i.value=a.get("access_token"),i.value?console.log("Access Token (from hash):",i.value):console.warn("Access token not found in URL hash.")}console.log("Change Password Page")});const b=async()=>{t.value=!0,n.value=null,r.value=null,console.log("New Password: ",l.value);const a=k.query.access_token;a?console.log("Access token: ",a):console.log("no access token: ");try{a&&console.log("Access token: ",a);const{error:e}=await y.supabase.auth.updateUser({password:l.value});if(e)throw new Error(e.message);r.value="Password changed successfully! Redirecting to login...",m.notify({color:"positive",message:r.value,icon:"check_circle"}),setTimeout(()=>{_.push("/dashboard")},2e3)}catch(e){n.value=e.message||"An unexpected error occurred.",m.notify({color:"negative",message:n.value,icon:"warning"})}finally{t.value=!1}};return(a,e)=>(d(),V(N,{class:"reset-password",padding:""},{default:c(()=>[o(U,null,{default:c(()=>[o(v,null,{default:c(()=>e[2]||(e[2]=[w("div",{class:"text-h5"},"Change Password",-1)])),_:1}),o(v,null,{default:c(()=>[o(B,{onSubmit:b,class:"q-gutter-md"},{default:c(()=>[o(h,{filled:"",type:"password",modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=s=>l.value=s),label:"New Password","lazy-rules":"",rules:[s=>!!s||"Field is required",s=>s.length>=6||"Use at least 6 characters"]},null,8,["modelValue","rules"]),o(h,{filled:"",type:"password",modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=s=>g.value=s),label:"Confirm Password","lazy-rules":"",rules:[s=>!!s||"Field is required",s=>s===l.value||"Passwords do not match"]},null,8,["modelValue","rules"]),w("div",null,[o(q,{color:"primary",type:"submit",label:t.value?"Loading...":"Change Password",loading:t.value,disable:t.value},null,8,["label","loading","disable"])]),n.value?(d(),f("div",T,P(n.value),1)):p("",!0),r.value?(d(),f("div",E,P(r.value),1)):p("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}},$=R(F,[["__scopeId","data-v-3376b8a0"]]);export{$ as default};
