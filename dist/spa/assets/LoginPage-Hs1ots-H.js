import{Q as z,a as q,b as I,c as Q}from"./QTabPanels-77vViQvk.js";import{b as M,i as Z,g as T,e as D,f as B,u as h,h as S,j as w,k as V,l as L,c as P,o as x,w as n,a as e,m as g,Q as y,n as U,p as _,q as b,s as K,t as A,v as C,x as N,y as F,z as R}from"./index-CEJet-6z.js";import{Q as k}from"./QForm-CCQUbe-V.js";import{Q as j}from"./QPage-JXBaRaDt.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./QResizeObserver-DY3qDIjD.js";import"./rtl-DFPa-2ov.js";import"./touch-BjYP5sR0.js";import"./selection-NY_xyrEA.js";function E(l){if(l===!1)return 0;if(l===!0||l===void 0)return 1;const t=parseInt(l,10);return isNaN(t)?0:t}const H=M({name:"close-popup",beforeMount(l,{value:t}){const i={depth:E(t),handler(r){i.depth!==0&&setTimeout(()=>{const o=T(l);o!==void 0&&D(o,r,i.depth)})},handlerKey(r){Z(r,13)===!0&&i.handler(r)}};l.__qclosepopup=i,l.addEventListener("click",i.handler),l.addEventListener("keyup",i.handlerKey)},updated(l,{value:t,oldValue:i}){t!==i&&(l.__qclosepopup.depth=E(t))},beforeUnmount(l){const t=l.__qclosepopup;l.removeEventListener("click",t.handler),l.removeEventListener("keyup",t.handlerKey),delete l.__qclosepopup}}),W={class:"q-mt-md"},G={class:"text-center q-mt-sm"},J={__name:"LoginForm",setup(l){const t=B(),i=h(),{showSuccess:r,showError:o}=S(),m=w(!0),p=V(()=>i.loading),u=L({email:"",password:""}),d=f=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(f)||"Invalid email format",c=()=>{t.push({name:"reset-password"})},v=async()=>{let f=await i.loginUser(u);const{success:s,error:a}=f;s&&(r("Login successful!"),t.push("/dashboard")),a&&o(a)};return(f,s)=>(x(),P(k,{onSubmit:v,class:"q-gutter-md"},{default:n(()=>[e(y,{modelValue:u.email,"onUpdate:modelValue":s[0]||(s[0]=a=>u.email=a),label:"Email",type:"email",outlined:"",rules:[a=>!!a||"Email is required",d]},null,8,["modelValue","rules"]),e(y,{modelValue:u.password,"onUpdate:modelValue":s[2]||(s[2]=a=>u.password=a),label:"Password",type:m.value?"password":"text",outlined:"",rules:[a=>!!a||"Password is required"]},{append:n(()=>[e(U,{name:m.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[1]||(s[1]=a=>m.value=!m.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),g("div",W,[e(_,{label:"Sign In",type:"submit",color:"primary",class:"full-width",loading:p.value},null,8,["loading"])]),g("div",G,[e(_,{flat:"",color:"primary",label:"Forgot Password?",onClick:c,disable:p.value},null,8,["disable"])])]),_:1}))}},O={class:"q-mt-md"},X={__name:"MagicLinkLogin",setup(l){const t=h(),{showSuccess:i,showError:r}=S(),o=w(""),m=V(()=>t.loading),p=d=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(d)||"Invalid email format",u=async()=>{const{success:d,error:c}=await t.signInWithMagicLink(o.value);c?r(c.message):d&&i("Magic link sent! Check your email to sign in.")};return(d,c)=>(x(),P(k,{onSubmit:u,class:"q-gutter-md"},{default:n(()=>[e(y,{modelValue:o.value,"onUpdate:modelValue":c[0]||(c[0]=v=>o.value=v),label:"Email for Magic Link",type:"email",outlined:"",rules:[v=>!!v||"Email is required",p]},null,8,["modelValue","rules"]),g("div",O,[e(_,{label:"Send Magic Link",type:"submit",color:"secondary",class:"full-width",loading:m.value},null,8,["loading"])])]),_:1}))}},Y={class:"text-center"},ee={__name:"AuthCard",emits:["show-signup"],setup(l){const t=h(),i=V(()=>t.loading);return(r,o)=>(x(),P(C,{class:"auth-card"},{default:n(()=>[e(b,{class:"text-center"},{default:n(()=>o[1]||(o[1]=[g("div",{class:"text-h4 text-primary q-mb-md"},"High Risk Patient Medication Audit",-1),g("div",{class:"text-subtitle1 q-mb-lg"},"Please sign in to continue",-1)])),_:1}),e(b,null,{default:n(()=>[K(r.$slots,"main-content",{},void 0,!0)]),_:3}),e(A,{class:"q-my-md"}),e(b,null,{default:n(()=>[g("div",Y,[o[2]||(o[2]=g("p",{class:"text-grey-8"},"Don't have an account?",-1)),e(_,{outline:"",color:"secondary",label:"Sign Up",class:"full-width",onClick:o[0]||(o[0]=m=>r.$emit("show-signup")),disable:i.value},null,8,["disable"])])]),_:1})]),_:3}))}},ae=$(ee,[["__scopeId","data-v-817fe71e"]]),se={class:"q-mt-md"},te={__name:"LoginPage",setup(l){const t=h(),{showSuccess:i,showError:r}=S(),o=w("password"),m=V(()=>t.loading),p=w(!1),u=w(!0),d=L({email:"",password:""}),c=f=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(f)||"Invalid email format",v=async()=>{console.log("credentials: ",d);let f=await t.registerUser(d);const{success:s,error:a}=f;s&&(i("Sign up successful! Please check your email for verification."),p.value=!1),a&&r(a.message||"Sign up failed")};return(f,s)=>(x(),P(j,{padding:"",class:"flex flex-center"},{default:n(()=>[e(ae,{onShowSignup:s[2]||(s[2]=a=>p.value=!0)},{"main-content":n(()=>[e(z,{modelValue:o.value,"onUpdate:modelValue":s[0]||(s[0]=a=>o.value=a),dense:"",class:"text-grey","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:n(()=>[e(q,{name:"password",label:"Email/Password"}),e(q,{name:"magiclink",label:"Magic Link"})]),_:1},8,["modelValue"]),e(A),e(I,{modelValue:o.value,"onUpdate:modelValue":s[1]||(s[1]=a=>o.value=a),animated:""},{default:n(()=>[e(Q,{name:"password"},{default:n(()=>[e(J)]),_:1}),e(Q,{name:"magiclink"},{default:n(()=>[e(X)]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(N,{modelValue:p.value,"onUpdate:modelValue":s[6]||(s[6]=a=>p.value=a)},{default:n(()=>[e(C,{style:{"min-width":"350px"}},{default:n(()=>[e(b,{class:"text-center"},{default:n(()=>s[7]||(s[7]=[g("div",{class:"text-h6"},"Create Account",-1)])),_:1}),e(b,null,{default:n(()=>[e(k,{onSubmit:v,class:"q-gutter-md"},{default:n(()=>[e(y,{modelValue:d.email,"onUpdate:modelValue":s[3]||(s[3]=a=>d.email=a),label:"Email",type:"email",outlined:"",rules:[a=>!!a||"Email is required",c]},null,8,["modelValue","rules"]),e(y,{modelValue:d.password,"onUpdate:modelValue":s[5]||(s[5]=a=>d.password=a),label:"Password",type:u.value?"password":"text",outlined:"",rules:[a=>!!a||"Password is required",a=>a.length>=6||"Password must be at least 6 characters"]},{append:n(()=>[e(U,{name:u.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:s[4]||(s[4]=a=>u.value=!u.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),g("div",se,[e(_,{label:"Sign Up",type:"submit",color:"secondary",class:"full-width",loading:m.value},null,8,["loading"])])]),_:1})]),_:1}),e(F,{align:"right"},{default:n(()=>[R(e(_,{flat:"",label:"Cancel",color:"primary",disable:m.value},null,8,["disable"]),[[H]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},pe=$(te,[["__scopeId","data-v-fc4fed60"]]);export{pe as default};
