import{f as u,_ as p,al as b,c as Q,o as i,w as c,u as V,a as o,Q as x,j as f,k as v,a3 as w,a0 as _,l as h,n as q,a2 as k}from"./index-DljHOSNM.js";import{Q as A}from"./QForm-5_ujR3j1.js";import{Q as B}from"./QPage-TxAkZhEo.js";import{useAuthStore as N}from"./auth-store-Bqp2eyR4.js";import{u as S}from"./use-quasar-Dm_ahj7J.js";import{_ as U}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-CqFgFOq9.js";const R={key:0,class:"text-red"},T={key:1,class:"text-green"},E={__name:"ChangePasswordPage",setup(F){const l=u(""),m=u(""),t=u(!1),r=u(null),n=u(null),y=V(),d=b(),P=N(),g=S();p(()=>{p(()=>{const a=d.query.access_token||d.params.access_token;a?console.log("Access Token:",a):console.warn("Access token not found in URL.")}),console.log("Change Password Page")});const C=async()=>{t.value=!0,r.value=null,n.value=null,console.log("New Password: ",l.value);const a=d.query.access_token;a?console.log("Access token: ",a):console.log("no access token: ");try{a&&console.log("Access token: ",a);const{error:e}=await P.supabase.auth.updateUser({password:l.value});if(e)throw new Error(e.message);n.value="Password changed successfully! Redirecting to login...",g.notify({color:"positive",message:n.value,icon:"check_circle"}),setTimeout(()=>{y.push("/dashboard")},2e3)}catch(e){r.value=e.message||"An unexpected error occurred.",g.notify({color:"negative",message:r.value,icon:"warning"})}finally{t.value=!1}};return(a,e)=>(i(),Q(B,{class:"reset-password",padding:""},{default:c(()=>[o(x,null,{default:c(()=>[o(f,null,{default:c(()=>e[2]||(e[2]=[v("div",{class:"text-h5"},"Change Password",-1)])),_:1}),o(f,null,{default:c(()=>[o(A,{onSubmit:C,class:"q-gutter-md"},{default:c(()=>[o(h,{filled:"",type:"password",modelValue:l.value,"onUpdate:modelValue":e[0]||(e[0]=s=>l.value=s),label:"New Password","lazy-rules":"",rules:[s=>!!s||"Field is required",s=>s.length>=6||"Use at least 6 characters"]},null,8,["modelValue","rules"]),o(h,{filled:"",type:"password",modelValue:m.value,"onUpdate:modelValue":e[1]||(e[1]=s=>m.value=s),label:"Confirm Password","lazy-rules":"",rules:[s=>!!s||"Field is required",s=>s===l.value||"Passwords do not match"]},null,8,["modelValue","rules"]),v("div",null,[o(q,{color:"primary",type:"submit",label:t.value?"Loading...":"Change Password",loading:t.value,disable:t.value},null,8,["label","loading","disable"])]),r.value?(i(),w("div",R,k(r.value),1)):_("",!0),n.value?(i(),w("div",T,k(n.value),1)):_("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}},G=U(E,[["__scopeId","data-v-48e19f47"]]);export{G as default};
