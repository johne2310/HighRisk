import{aD as c,f as o,h as g}from"./index-rcwsilPX.js";import{e as u}from"./index-kDORiqQ7.js";const m=c("auth",()=>{const n=o(null),s=o(!1),a=o(null),i=g(()=>!!n.value);return{user:n,loading:s,error:a,isAuthenticated:i,initialize:async()=>{s.value=!0,a.value=null;try{const{data:{session:e},error:r}=await u.auth.getSession();if(r)throw r;e?n.value=e.user:n.value=null}catch(e){console.error("Error initializing auth store:",e),a.value=e.message,n.value=null}finally{s.value=!1}u.auth.onAuthStateChange((e,r)=>{r?n.value=r.user:n.value=null})},signIn:async(e,r)=>{s.value=!0,a.value=null;try{const{data:t,error:l}=await u.auth.signInWithPassword({email:e,password:r});if(l)throw l;return n.value=t.user,console.log("User is: ",n),{success:!0}}catch(t){return console.error("Error signing in:",t),a.value=t.message,{success:!1,error:t.message}}finally{s.value=!1}},signUp:async(e,r)=>{s.value=!0,a.value=null;try{const{data:t,error:l}=await u.auth.signUp({email:e,password:r,options:{emailRedirectTo:"https://www.day41.app/#/login"}});if(l)throw l;return{success:!0,data:t}}catch(t){return console.error("Error signing up:",t),a.value=t.message,{success:!1,error:t.message}}finally{s.value=!1}},signOut:async()=>{s.value=!0,a.value=null;try{const{error:e}=await u.auth.signOut();if(e)throw e;return n.value=null,{success:!0}}catch(e){return console.error("Error signing out:",e),a.value=e.message,{success:!1,error:e.message}}finally{s.value=!1}},resetPassword:async e=>{s.value=!0,a.value=null;try{const{error:r}=await u.auth.resetPasswordForEmail(e,{redirectTo:"https://www.day41.app/#/change-passwor"});if(r)throw r;return{success:!0}}catch(r){return console.error("Error resetting password:",r),a.value=r.message,{success:!1,error:r.message}}finally{s.value=!1}}}});export{m as useAuthStore};
