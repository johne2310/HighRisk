import{b as C,i as E,g as L,e as A,f as u,h as I,c as D,o as $,w as o,u as B,a as l,Q as P,j as y,k as r,l as b,m as q,n as m,p as K,q as N,s as z,t as M}from"./index-Mv9NdxZw.js";import{Q as V}from"./QForm-CTa37q6O.js";import{Q as R}from"./QPage-CsuigWOP.js";import{u as Z}from"./use-quasar-BoCZ60f5.js";import{useAuthStore as F}from"./auth-store-D4RxGKel.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-M353X4_W.js";function k(t){if(t===!1)return 0;if(t===!0||t===void 0)return 1;const a=parseInt(t,10);return isNaN(a)?0:a}const H=C({name:"close-popup",beforeMount(t,{value:a}){const i={depth:k(a),handler(n){i.depth!==0&&setTimeout(()=>{const d=L(t);d!==void 0&&A(d,n,i.depth)})},handlerKey(n){E(n,13)===!0&&i.handler(n)}};t.__qclosepopup=i,t.addEventListener("click",i.handler),t.addEventListener("keyup",i.handlerKey)},updated(t,{value:a,oldValue:i}){a!==i&&(t.__qclosepopup.depth=k(a))},beforeUnmount(t){const a=t.__qclosepopup;t.removeEventListener("click",a.handler),t.removeEventListener("keyup",a.handlerKey),delete t.__qclosepopup}}),T={class:"q-mt-md"},W={class:"text-center q-mt-sm"},G={class:"text-center"},J={class:"q-mt-md"},O={__name:"LoginPage",setup(t){const a=Z(),i=B(),n=F(),d=u(""),h=u(""),f=u(!0),p=I(()=>n.loading),v=u(!1),w=u(""),_=u(""),g=u(!0),x=c=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(c)||"Invalid email format",Q=()=>{i.push("/reset-password")},S=async()=>{const{success:c,error:e}=await n.signInWithMagicLink(d.value);c?(a.notify({color:"positive",message:"Login successful",icon:"check_circle"}),await i.push("/dashboard")):a.notify({color:"negative",message:e||"Login failed",icon:"error"})},U=async()=>{const{success:c,error:e}=await n.signUp(w.value,_.value);c?(a.notify({color:"positive",message:"Sign up successful! Please check your email for verification.",icon:"check_circle"}),v.value=!1):a.notify({color:"negative",message:e||"Sign up failed",icon:"error"})};return(c,e)=>($(),D(R,{padding:"",class:"flex flex-center"},{default:o(()=>[l(P,{class:"auth-card"},{default:o(()=>[l(y,{class:"text-center"},{default:o(()=>e[8]||(e[8]=[r("div",{class:"text-h4 text-primary q-mb-md"},"High Risk Patient Medication Audit",-1),r("div",{class:"text-subtitle1 q-mb-lg"},"Please sign in to continue",-1)])),_:1}),l(y,null,{default:o(()=>[l(V,{onSubmit:S,class:"q-gutter-md"},{default:o(()=>[l(b,{modelValue:d.value,"onUpdate:modelValue":e[0]||(e[0]=s=>d.value=s),label:"Email",type:"email",outlined:"",rules:[s=>!!s||"Email is required",x]},null,8,["modelValue","rules"]),l(b,{modelValue:h.value,"onUpdate:modelValue":e[2]||(e[2]=s=>h.value=s),label:"Password",type:f.value?"password":"text",outlined:"",rules:[s=>!!s||"Password is required"]},{append:o(()=>[l(q,{name:f.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[1]||(e[1]=s=>f.value=!f.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),r("div",T,[l(m,{label:"Sign In",type:"submit",color:"primary",class:"full-width",loading:p.value},null,8,["loading"])]),r("div",W,[l(m,{flat:"",color:"primary",label:"Forgot Password?",onClick:Q,disable:p.value},null,8,["disable"])]),l(K,{class:"q-my-md"}),r("div",G,[e[9]||(e[9]=r("p",{class:"text-grey-8"},"Don't have an account?",-1)),l(m,{outline:"",color:"secondary",label:"Sign Up",class:"full-width",onClick:e[3]||(e[3]=s=>v.value=!0),disable:p.value},null,8,["disable"])])]),_:1})]),_:1})]),_:1}),l(N,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=s=>v.value=s)},{default:o(()=>[l(P,{style:{"min-width":"350px"}},{default:o(()=>[l(y,{class:"text-center"},{default:o(()=>e[10]||(e[10]=[r("div",{class:"text-h6"},"Create Account",-1)])),_:1}),l(y,null,{default:o(()=>[l(V,{onSubmit:U,class:"q-gutter-md"},{default:o(()=>[l(b,{modelValue:w.value,"onUpdate:modelValue":e[4]||(e[4]=s=>w.value=s),label:"Email",type:"email",outlined:"",rules:[s=>!!s||"Email is required",x]},null,8,["modelValue","rules"]),l(b,{modelValue:_.value,"onUpdate:modelValue":e[6]||(e[6]=s=>_.value=s),label:"Password",type:g.value?"password":"text",outlined:"",rules:[s=>!!s||"Password is required",s=>s.length>=6||"Password must be at least 6 characters"]},{append:o(()=>[l(q,{name:g.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[5]||(e[5]=s=>g.value=!g.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),r("div",J,[l(m,{label:"Sign Up",type:"submit",color:"secondary",class:"full-width",loading:p.value},null,8,["loading"])])]),_:1})]),_:1}),l(z,{align:"right"},{default:o(()=>[M(l(m,{flat:"",label:"Cancel",color:"primary",disable:p.value},null,8,["disable"]),[[H]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},oe=j(O,[["__scopeId","data-v-acb73a7b"]]);export{oe as default};
