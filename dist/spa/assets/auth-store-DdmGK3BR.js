import{aD as c,f as u,h as g}from"./index-jai8ZP5L.js";import{e as l}from"./index-Co96NoFD.js";const E=c("auth",()=>{const t=u(null),s=u(!1),a=u(null),i=g(()=>!!t.value);return{user:t,loading:s,error:a,isAuthenticated:i,initialize:async()=>{s.value=!0,a.value=null;try{const{data:{session:e},error:r}=await l.auth.getSession();if(r)throw r;e?t.value=e.user:t.value=null}catch(e){console.error("Error initializing auth store:",e),a.value=e.message,t.value=null}finally{s.value=!1}l.auth.onAuthStateChange((e,r)=>{r?t.value=r.user:t.value=null,e==="SIGNED_IN"&&console.log("Signed in"),e==="SIGNED_OUT"&&console.log("Signed out"),e==="PASSWORD_RECOVERY"&&console.log("Password recovery"),e==="EMAIL_VERIFICATION"&&console.log("Email verification")})},signIn:async(e,r)=>{s.value=!0,a.value=null;try{const{data:o,error:n}=await l.auth.signInWithPassword({email:e,password:r});if(n)throw n;return t.value=o.user,console.log("User is: ",t),{success:!0}}catch(o){return console.error("Error signing in:",o),a.value=o.message,{success:!1,error:o.message}}finally{s.value=!1}},signUp:async(e,r)=>{s.value=!0,a.value=null;try{const{data:o,error:n}=await l.auth.signUp({email:e,password:r,options:{emailRedirectTo:"https://www.day41.app/#/login"}});if(n)throw n;return{success:!0,data:o}}catch(o){return console.error("Error signing up:",o),a.value=o.message,{success:!1,error:o.message}}finally{s.value=!1}},signOut:async()=>{s.value=!0,a.value=null;try{const{error:e}=await l.auth.signOut();if(e)throw e;return t.value=null,{success:!0}}catch(e){return console.error("Error signing out:",e),a.value=e.message,{success:!1,error:e.message}}finally{s.value=!1}},resetPassword:async e=>{s.value=!0,a.value=null;try{const{error:r}=await l.auth.resetPasswordForEmail(e,{redirectTo:"https://www.day41.apps/#/change-password"});if(r)throw r;return{success:!0}}catch(r){return console.error("Error resetting password:",r),a.value=r.message,{success:!1,error:r.message}}finally{s.value=!1}}}});export{E as useAuthStore};
