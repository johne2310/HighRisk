import{b as C,i as E,g as L,e as A,f as c,h as I,c as D,o as $,w as o,u as B,a as l,Q as h,j as y,k as d,l as b,m as q,n as p,p as K,q as N,s as z,t as F}from"./index-BoLhqfK_.js";import{Q as V}from"./QForm-SQgNKDqC.js";import{Q as Z}from"./QPage-BuEZuBGA.js";import{u as M}from"./use-quasar-DxyMPru8.js";import{useAuthStore as R}from"./auth-store-B5eeVrVC.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./index-DqhnTqPF.js";function k(t){if(t===!1)return 0;if(t===!0||t===void 0)return 1;const a=parseInt(t,10);return isNaN(a)?0:a}const H=C({name:"close-popup",beforeMount(t,{value:a}){const i={depth:k(a),handler(n){i.depth!==0&&setTimeout(()=>{const r=L(t);r!==void 0&&A(r,n,i.depth)})},handlerKey(n){E(n,13)===!0&&i.handler(n)}};t.__qclosepopup=i,t.addEventListener("click",i.handler),t.addEventListener("keyup",i.handlerKey)},updated(t,{value:a,oldValue:i}){a!==i&&(t.__qclosepopup.depth=k(a))},beforeUnmount(t){const a=t.__qclosepopup;t.removeEventListener("click",a.handler),t.removeEventListener("keyup",a.handlerKey),delete t.__qclosepopup}}),T={class:"q-mt-md"},G={class:"text-center q-mt-sm"},J={class:"text-center"},O={class:"q-mt-md"},W={__name:"LoginPage",setup(t){const a=M(),i=B(),n=R(),r=c(""),w=c(""),f=c(!0),m=I(()=>n.loading),v=c(!1),P=c(""),_=c(""),g=c(!0),x=u=>/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(u)||"Invalid email format",Q=async()=>{const{success:u,error:e}=await n.signIn(r.value,w.value);u?(a.notify({color:"positive",message:"Login successful",icon:"check_circle"}),i.push("/")):a.notify({color:"negative",message:e||"Login failed",icon:"error"})},S=async()=>{const{success:u,error:e}=await n.signUp(P.value,_.value);u?(a.notify({color:"positive",message:"Sign up successful! Please check your email for verification.",icon:"check_circle"}),v.value=!1):a.notify({color:"negative",message:e||"Sign up failed",icon:"error"})},U=async()=>{if(!r.value){a.notify({color:"warning",message:"Please enter your email address",icon:"warning"});return}const{success:u,error:e}=await n.resetPassword(r.value);u?a.notify({color:"positive",message:"Password reset email sent. Please check your inbox.",icon:"check_circle"}):a.notify({color:"negative",message:e||"Failed to send reset email",icon:"error"})};return(u,e)=>($(),D(Z,{padding:"",class:"flex flex-center"},{default:o(()=>[l(h,{class:"auth-card"},{default:o(()=>[l(y,{class:"text-center"},{default:o(()=>e[8]||(e[8]=[d("div",{class:"text-h4 text-primary q-mb-md"},"High Risk Patient Medication Audit",-1),d("div",{class:"text-subtitle1 q-mb-lg"},"Please sign in to continue",-1)])),_:1}),l(y,null,{default:o(()=>[l(V,{onSubmit:Q,class:"q-gutter-md"},{default:o(()=>[l(b,{modelValue:r.value,"onUpdate:modelValue":e[0]||(e[0]=s=>r.value=s),label:"Email",type:"email",outlined:"",rules:[s=>!!s||"Email is required",x]},null,8,["modelValue","rules"]),l(b,{modelValue:w.value,"onUpdate:modelValue":e[2]||(e[2]=s=>w.value=s),label:"Password",type:f.value?"password":"text",outlined:"",rules:[s=>!!s||"Password is required"]},{append:o(()=>[l(q,{name:f.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[1]||(e[1]=s=>f.value=!f.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),d("div",T,[l(p,{label:"Sign In",type:"submit",color:"primary",class:"full-width",loading:m.value},null,8,["loading"])]),d("div",G,[l(p,{flat:"",color:"primary",label:"Forgot Password?",onClick:U,disable:m.value},null,8,["disable"])]),l(K,{class:"q-my-md"}),d("div",J,[e[9]||(e[9]=d("p",{class:"text-grey-8"},"Don't have an account?",-1)),l(p,{outline:"",color:"secondary",label:"Sign Up",class:"full-width",onClick:e[3]||(e[3]=s=>v.value=!0),disable:m.value},null,8,["disable"])])]),_:1})]),_:1})]),_:1}),l(N,{modelValue:v.value,"onUpdate:modelValue":e[7]||(e[7]=s=>v.value=s)},{default:o(()=>[l(h,{style:{"min-width":"350px"}},{default:o(()=>[l(y,{class:"text-center"},{default:o(()=>e[10]||(e[10]=[d("div",{class:"text-h6"},"Create Account",-1)])),_:1}),l(y,null,{default:o(()=>[l(V,{onSubmit:S,class:"q-gutter-md"},{default:o(()=>[l(b,{modelValue:P.value,"onUpdate:modelValue":e[4]||(e[4]=s=>P.value=s),label:"Email",type:"email",outlined:"",rules:[s=>!!s||"Email is required",x]},null,8,["modelValue","rules"]),l(b,{modelValue:_.value,"onUpdate:modelValue":e[6]||(e[6]=s=>_.value=s),label:"Password",type:g.value?"password":"text",outlined:"",rules:[s=>!!s||"Password is required",s=>s.length>=6||"Password must be at least 6 characters"]},{append:o(()=>[l(q,{name:g.value?"visibility_off":"visibility",class:"cursor-pointer",onClick:e[5]||(e[5]=s=>g.value=!g.value)},null,8,["name"])]),_:1},8,["modelValue","type","rules"]),d("div",O,[l(p,{label:"Sign Up",type:"submit",color:"secondary",class:"full-width",loading:m.value},null,8,["loading"])])]),_:1})]),_:1}),l(z,{align:"right"},{default:o(()=>[F(l(p,{flat:"",label:"Cancel",color:"primary",disable:m.value},null,8,["disable"]),[[H]])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},oe=j(W,[["__scopeId","data-v-31828617"]]);export{oe as default};
